{% extends 'base.html.twig' %}

{% block title %}Pixel Combat RPG{% endblock %}

{% block body %}
<div class="scanlines"></div>

<div class="pixel-container"
     data-controller="battle"
     data-battle-battle-url-value="{{ path('battle_tick') }}"
     data-battle-char1-hp-value="{{ battleState.char1.hp }}"
     data-battle-char2-hp-value="{{ battleState.char2.hp }}">
    <h1>PIXEL COMBAT RPG</h1>

     <div class="battle-screen pixel-border">
        <div class="battle-grid"></div>
        
        <!-- Pixel dust animation -->
        <div id="pixel-dust-container"></div>

        <!-- Game over message -->
        <div class="game-over" id="game-over">
            <div class="game-over-title">Game Over</div>
            <div class="winner-name" id="winner-name">Player 1 Wins!</div>
        </div>

        <div class="battle-arena">
            <!-- Character 1 -->
            <div class="character-panel pixel-border char-1" id="char1-panel">
                <div class="active-turn" id="turn-char1">TOUR</div>
                <div class="character-sprite pixel-border">
                    <div class="sprite-placeholder">{{ battleState.char1.name|slice(0, 1) }}</div>
                </div>
                <div class="character-info">
                    <div class="character-name">{{ battleState.char1.name }}</div>
                    <div class="health-label">
                        <span>HP</span>
                        <span id="hp-char1-text">{{ battleState.char1.hp }}/{{ battleState.char1.hp }}</span>
                    </div>
                    <div class="health-bar-container">
                        {% set ratioChar1 = (battleState.char1.hp / 100) * 100 %}
                        <div class="health-bar" id="health-bar-char1" style="width: {{ ratioChar1 }}%;">
                            <div class="health-text">{{ battleState.char1.hp }}/{{ battleState.char1.hp }}</div>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-value">7</div>
                            <div class="stat-name">ATK</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">5</div>
                            <div class="stat-name">SPD</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">8</div>
                            <div class="stat-name">DEF</div>
                        </div>
                    </div>
                </div>
                <div class="damage-effect" id="damage-char1">-10</div>
            </div>

            <!-- Character 2 -->
            <div class="character-panel pixel-border char-2" id="char2-panel">
                <div class="active-turn" id="turn-char2">TOUR</div>
                <div class="character-sprite pixel-border">
                    <div class="sprite-placeholder">{{ battleState.char2.name|slice(0, 1) }}</div>
                </div>
                <div class="character-info">
                    <div class="character-name">{{ battleState.char2.name }}</div>
                    <div class="health-label">
                        <span>HP</span>
                        <span id="hp-char2-text">{{ battleState.char2.hp }}/{{ battleState.char2.hp }}</span>
                    </div>
                    <div class="health-bar-container">
                        {% set ratioChar2 = (battleState.char2.hp / 100) * 100 %}
                        <div class="health-bar" id="health-bar-char2" style="width: {{ ratioChar2 }}%;">
                            <div class="health-text">{{ battleState.char2.hp }}/{{ battleState.char2.hp }}</div>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-value">9</div>
                            <div class="stat-name">ATK</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">4</div>
                            <div class="stat-name">SPD</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">6</div>
                            <div class="stat-name">DEF</div>
                        </div>
                    </div>
                </div>
                <div class="damage-effect" id="damage-char2">-10</div>
            </div>
        </div>

        <div class="battle-controls">
            <button class="pixel-button btn-start" id="btn-start">START</button>
            <button class="pixel-button btn-pause" id="btn-pause" style="display: none;">PAUSE</button>
        </div>
    </div>

    <div class="battle-log pixel-border">
        <div class="log-header">
            <div class="log-title">COMBAT LOG</div>
            <div class="turn-counter" id="turn-counter">TURN 1</div>
        </div>
        <div class="log-messages" id="log-messages">
            {% for log in battleState.logs %}
                <div class="log-message log-system">{{ log }}</div>
            {% endfor %}
        </div>
    </div>
</div>


{% endblock %}