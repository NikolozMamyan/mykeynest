
<style>
@keyframes navFadeIn { from {opacity:0} to {opacity:1} }

.landing-nav{
  position:fixed; inset:0 0 auto 0; height:64px;
  background:rgba(255,255,255,.98); backdrop-filter:blur(10px);
  border-bottom:1px solid var(--color-border);
  z-index:1000;
  display:flex; align-items:center; padding:0;
}
.nav-container{
  max-width:1280px; margin:0 auto; padding:0 1rem;
  display:flex; align-items:center; justify-content:space-between; width:100%;
}
.landing-nav.scrolled{ box-shadow:var(--shadow-sm); }

.nav-toggle{
  display:inline-flex; align-items:center; gap:.5rem;
  border:1px solid var(--color-border); background:#fff;
  border-radius:8px; padding:.5rem .75rem; width:50px;
}

.nav-links{
  display:none;
  position:fixed; left:0; right:0; top:64px;
  background:#fff; border-bottom:1px solid var(--color-border);
  padding:1rem 1.25rem; gap:1rem; flex-direction:column;
  z-index:999;
}
.nav-links.active{ display:flex; animation:navFadeIn .2s ease; }

.nav-cta{ display:none; gap:.75rem; align-items:center }
.nav-cta-mobile{ display:flex; gap:.75rem; margin-top:.5rem }

/* Overlay menu mobile */
.nav-overlay{
  position:fixed; inset:64px 0 0 0; background:rgba(0,0,0,.35);
  opacity:0; pointer-events:none; transition:opacity .2s ease; z-index:998;
}
.nav-overlay.active{ opacity:1; pointer-events:auto; }

/* Liens */
.nav-link{
  color:var(--color-text-medium);
  text-decoration:none;
  font-weight:500;
  font-size:.95rem;
  transition:color .3s ease;
  position:relative;
}
.nav-link:hover{ color:var(--color-primary); }

/* Boutons (utilisés dans la nav) */
.btn{
  padding:.625rem 1.25rem;
  border-radius:var(--border-radius-sm);
  font-weight:600;
  font-size:.9rem;
  text-decoration:none;
  transition:all .3s ease;
  border:none;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:.5rem;
  min-height:44px;
}
.btn-outline{
  color:var(--color-text-dark);
  background:transparent;
  border:1px solid var(--color-border);
}
.btn-outline:hover{
  background:var(--color-bg-light);
  border-color:var(--color-primary);
  color:var(--color-primary);
}
.btn-primary{
  background:var(--color-primary);
  color:var(--color-white);
  border:1px solid var(--color-primary);
}
.btn-primary:hover{
  background:#047857;
  box-shadow:var(--shadow-green);
  animation:pulse 1.5s ease-in-out infinite;
}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.02)}}

/* Responsive */
@media (min-width:1025px){
  .nav-toggle{ display:none !important; }
  .nav-links{
    display:flex;
    position:static;
    padding:0;
    flex-direction:row;
    gap:2rem;
    border:0;
    background:transparent;
  }
  .nav-cta{ display:flex; }
  .nav-cta-mobile{ display:none; }
  .nav-overlay{ display:none; }
}
@media (min-width:1025px){
  .nav-toggle, .nav-lang-mobile{ display:none }
  .nav-links{ display:flex; position:static; padding:0; flex-direction:row; gap:2rem; border:0; background:transparent }
  .nav-cta{ display:flex }
  .nav-cta-mobile{ display:none }
  .nav-overlay{ display:none }
}
.nav-lang-mobile{
  margin-bottom:.75rem;
  padding-bottom:.75rem;
  border-bottom:1px solid var(--color-border);
}


/* Accessibilité focus */
*:focus-visible{ outline:3px solid var(--color-primary); outline-offset:2px; }
</style>

<nav class="landing-nav" id="navbar" role="navigation" aria-label="{{ 'landing.nav.aria'|trans }}">
  <div class="nav-container">
    {% include 'components/parts/logo.html.twig' %}

    <button class="btn nav-toggle" id="mobile-menu-btn" aria-controls="primary-nav" aria-expanded="false">
      <i class="fas fa-bars" aria-hidden="true"></i>
    </button>

    <div class="nav-links" id="primary-nav">
      <div class="nav-lang nav-lang-mobile" role="group" aria-label="{{ 'landing.nav.language'|trans }}">
  {% set route = app.request.attributes.get('_route') %}

{% if route starts with 'blog_' %}
  {% include 'components/parts/blog_lang_switcher.html.twig' %}
{% else %}
  {% include 'components/parts/lang_switcher.html.twig' %}
{% endif %}
  </div>
      <a href="/#features" class="nav-link">{{ 'landing.nav.features'|trans }}</a>
      <a href="{{path('app_help_center')}}" class="nav-link">{{ 'landing.nav.how_it_works'|trans }}</a>
      <a href="/#pricing" class="nav-link">{{ 'landing.nav.pricing'|trans }}</a>

      <a href="{{ path('blog_index', { _locale: app.request.locale }) }}"
         lang="{{ app.request.locale }}" class="nav-link">
        {{ 'landing.footer.links.blog'|trans }}
      </a>


      <div class="nav-cta nav-cta-mobile">
        <a href="{{ path('show_login') }}" class="btn btn-outline">{{ 'landing.nav.login'|trans }}</a>
        <a href="{{ path('show_register') }}" class="btn btn-primary">{{ 'landing.nav.free_trial'|trans }}</a>
      </div>
    </div>

    <div class="nav-cta">
      <a href="{{ path('show_login') }}" class="btn btn-outline">{{ 'landing.nav.login'|trans }}</a>
      <a href="{{ path('show_register') }}" class="btn btn-primary">{{ 'landing.nav.free_trial'|trans }}</a>

      <div class="nav-lang" role="group" aria-label="{{ 'landing.nav.language'|trans }}">
{% set route = app.request.attributes.get('_route') %}

{% if route starts with 'blog_' %}
  {% include 'components/parts/blog_lang_switcher.html.twig' %}
{% else %}
  {% include 'components/parts/lang_switcher.html.twig' %}
{% endif %}

  
      </div>
    </div>
  </div>
</nav>

<div class="nav-overlay" id="nav-overlay" aria-hidden="true"></div>


<script defer>
/* NAVBAR shadow on scroll */
(function () {
  const navbar = document.getElementById('navbar');
  if (!navbar) return;

  const onScroll = () => navbar.classList.toggle('scrolled', window.scrollY > 50);
  window.addEventListener('scroll', onScroll, { passive: true });
  onScroll();
})();

/* Mobile menu toggle + overlay + close behaviors */
(function () {
  const toggle = document.getElementById('mobile-menu-btn');
  const nav = document.getElementById('primary-nav');
  const overlay = document.getElementById('nav-overlay');

  if (!toggle || !nav || !overlay) return;

  const setOpen = (open) => {
    nav.classList.toggle('active', open);
    overlay.classList.toggle('active', open);
    toggle.setAttribute('aria-expanded', String(open));
    document.body.style.overflow = open ? 'hidden' : '';
  };

  toggle.addEventListener('click', () => setOpen(!nav.classList.contains('active')));

  overlay.addEventListener('click', () => setOpen(false));

  // Ferme au clic sur un lien du menu (mobile)
  nav.addEventListener('click', (e) => {
    const a = e.target.closest('a');
    if (!a) return;
    // si anchor interne, on ferme le menu
    setOpen(false);
  });

  // Ferme avec ESC
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') setOpen(false);
  });
})();

/* Smooth scroll (respecte reduced motion) */
(function () {
  document.querySelectorAll('a[href^="#"]').forEach(a => {
    a.addEventListener('click', (e) => {
      const id = a.getAttribute('href');
      if (!id || id === "#" || id === "#!") return;

      const target = document.querySelector(id);
      if (!target) return;

      e.preventDefault();

      const header = document.querySelector('.landing-nav');
      const offset = (header ? header.offsetHeight : 0) + 20;

      const y = target.getBoundingClientRect().top + window.scrollY - offset;

      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        window.scrollTo(0, y);
      } else {
        window.scrollTo({ top: y, behavior: 'smooth' });
      }
    });
  });
})();
</script>